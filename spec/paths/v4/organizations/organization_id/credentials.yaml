get:
  operationId: getCredentials
  tags:
    - organizations
  summary: Get credentials
  description: >
    Returns credentials for an organization, if available.

    For more information on credentials,

    see [Set credentials](#operation/addCredentials).


    Here is another paragraph.


    ### Example response body for AWS


    ```json

    [
      {
        "id": "a1b2c3",
        "provider": "aws",
        "aws": {
          "roles": {
            "admin": "arn:aws:iam::123456789012:role/GiantSwarmAdmin",
            "awsoperator": "arn:aws:iam::123456789012:role/GiantSwarmAWSOperator"
          }
        }
      }
    ]

    ```


    ### Example response body for Azure


    ```json

    [
      {
        "id": "a1b2c3",
        "provider": "azure",
        "azure": {
          "credential": {
            "client_id": "c93bf55e-5bf7-4966-ad2b-e6f6e7721d50",
            "subscription_id": "b388b7c7-4479-4040-9ac5-1e13edd6b1cd",
            "tenant_id": "3dd2e94a-92ba-434c-99be-32bb65864a99"
          }
        }
      }
    ]

    ```
  parameters:
    - $ref: "../../../../components.yaml#/components/parameters/RequiredGiantSwarmAuthorizationHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XRequestIDHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XGiantSwarmActivityHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XGiantSwarmCmdLineHeader"
    - $ref: "../../../../components.yaml#/components/parameters/OrganizationIdPathParameter"
  responses:
    "200":
      description: Credentials
      content:
        application/json:
          schema:
            $ref: "../../../../components.yaml#/components/schemas/V4GetCredentialsResponse"
          examples:
            response:
              value:
                - id: a1b2c3
                  provider: azure
                  azure:
                    credential:
                      client_id: c93bf55e-5bf7-4966-ad2b-e6f6e7721d50
                      subscription_id: b388b7c7-4479-4040-9ac5-1e13edd6b1cd
                      tenant_id: 3dd2e94a-92ba-434c-99be-32bb65864a99
    default:
      description: error
      content:
        application/json:
          schema:
            $ref: "../../../../components.yaml#/components/schemas/V4GenericResponse"
post:
  operationId: addCredentials
  tags:
    - organizations
  summary: Set credentials
  description: >
    Add a set of credentials to the organization allowing the creation and

    operation of clusters within a cloud provider account/subscription.


    The actual type of these credentials depends on the cloud provider the

    installation is running on. AWS and Azure are currently supported.


    Credentials in an organization are immutable. Each organization can only

    have one set of credentials.


    Once credentials have been set for an organization, they are used for

    every new cluster that will be created for the organization.


    ### Example request body for AWS


    ```json

    {
      "provider": "aws",
      "aws": {
        "roles": {
          "admin": "arn:aws:iam::123456789012:role/GiantSwarmAdmin",
          "awsoperator": "arn:aws:iam::123456789012:role/GiantSwarmAWSOperator"
        }
      }
    }

    ```


    ### Example request body for Azure


    ```json

    {
      "provider": "azure",
      "azure": {
        "credential": {
          "client_id": "c93bf55e-5bf7-4966-ad2b-e6f6e7721d50",
          "secret_key": "720e38f7-3af4-463c-9313-abcdf2ead612",
          "subscription_id": "b388b7c7-4479-4040-9ac5-1e13edd6b1cd",
          "tenant_id": "3dd2e94a-92ba-434c-99be-32bb65864a99"
        }
      }
    }

    ```
  parameters:
    - $ref: "../../../../components.yaml#/components/parameters/RequiredGiantSwarmAuthorizationHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XRequestIDHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XGiantSwarmActivityHeader"
    - $ref: "../../../../components.yaml#/components/parameters/XGiantSwarmCmdLineHeader"
    - $ref: "../../../../components.yaml#/components/parameters/OrganizationIdPathParameter"
  requestBody:
    content:
      application/json:
        schema:
          $ref: "../../../../components.yaml#/components/schemas/V4AddCredentialsRequest"
    required: true
    x-examples:
      application/json:
        provider: aws
        aws:
          roles:
            admin: arn:aws:iam::123456789012:role/GiantSwarmAdmin
            awsoperator: arn:aws:iam::123456789012:role/GiantSwarmAWSOperator
  responses:
    "201":
      description: Credentials created
      headers:
        Location:
          description: URI of the new credentials resource
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "../../../../components.yaml#/components/schemas/V4GenericResponse"
          examples:
            response:
              value:
                code: RESOURCE_CREATED
                message: A new set of credentials has been created with ID '5d9h4'
    "401":
      $ref: "../../../../components.yaml#/components/responses/V4Generic401Response"
    "409":
      description: Conflict
      content:
        application/json:
          schema:
            $ref: "../../../../components.yaml#/components/schemas/V4GenericResponse"
          examples:
            response:
              value:
                code: RESOURCE_ALREADY_EXISTS
                message: The organisation already has a set of credentials
    default:
      description: error
      content:
        application/json:
          schema:
            $ref: "../../../../components.yaml#/components/schemas/V4GenericResponse"